<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rbot Vignette • Rbot</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Rbot Vignette">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rbot</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Rbot.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Rbot Vignette</h1>
                        <h4 class="author">Nico Katzke</h4>
            
            <h4 class="date">2018-08-26</h4>
      
      
      <div class="hidden name"><code>Rbot.Rmd</code></div>

    </div>

    
    
<div id="rbot-making-r-and-your-phone-best-friends" class="section level2">
<h2 class="hasAnchor">
<a href="#rbot-making-r-and-your-phone-best-friends" class="anchor"></a>Rbot: Making R and your Phone Best Friends</h2>
<div id="brief-overview" class="section level4">
<h4 class="hasAnchor">
<a href="#brief-overview" class="anchor"></a>Brief Overview</h4>
<p>This package is intended to be a simplifying tool to make R and your phone communicate, and motivate why this is a powerful combination. Rbot is a wrapper to the APIs developed from the Telegram community, and facilitates the use of the telegram and telegram.bot apps in R.</p>
<blockquote>
<p>Using this package, your workflow for setting up with your phone to talk to R is as simple as 1 2 3 4:</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><p>Install the Telegram app on your phone.</p></li>
<li><p>Open the app, and then send <a href="https://core.telegram.org/bots#6-botfather">botfather</a> the message: /newbot.</p></li>
</ol>
<ul>
<li>Click on the t.me/<botname>_bot link in the “Done! Congratulations…” message from botfather. Press start below and send your bot a message (“Hi Bot!”)</botname>
</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>In R, run the following code to save your bot’s credentials on your computer (assuming default locations apply):</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Token =<span class="st"> </span>YOURTOKEN  <span class="co"># given by the Botfather... Looks like: 3148997513::AFSIBIGEk2352235mpfFA</span>
<span class="kw"><a href="../reference/Add_Bot.html">Add_Bot</a></span>(<span class="dt">Token =</span> Token) <span class="co"># By default, this is saved in: path.expand("~")</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Now you can send messages, pdfs and images from R to your phone simply as follows:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Text:</span>
BOTNAME &lt;-<span class="st"> "MyRbot"</span>
Msg &lt;-<span class="st"> "Hello!"</span>
<span class="kw"><a href="../reference/Text_Bot.html">Text_Bot</a></span>(Msg, <span class="dt">Bot_Name =</span> BOTNAME)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># PDF:</span>
BOTNAME &lt;-<span class="st"> "MyRbot"</span>
Doc_Loc &lt;-<span class="st"> "SomePDF.PDF"</span>
<span class="kw"><a href="../reference/Doc_Bot.html">Doc_Bot</a></span>(<span class="dt">Doc_Location =</span> Doc_Loc, <span class="dt">Bot_Name =</span> BOTNAME)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Image:</span>
<span class="kw">png</span>(<span class="st">'Example_Plot.png'</span>)
<span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))
<span class="kw">dev.off</span>()

BOTNAME &lt;-<span class="st"> "MyRbot"</span>
Img_Loc &lt;-<span class="st"> "Example_Plot.png"</span>
<span class="kw"><a href="../reference/Pic_Bot.html">Pic_Bot</a></span>(<span class="dt">Img_Loc =</span> Img_Loc, <span class="dt">Caption =</span> <span class="st">"Cool Figure Right?"</span>, <span class="dt">Bot_Name =</span> BOTNAME)</code></pre></div>
<ul>
<li>The package also has a workflow for opening a connection that allow you to execute functions in R from your phone - see the next section.</li>
</ul>
</div>
<div id="detailed-overview" class="section level4">
<h4 class="hasAnchor">
<a href="#detailed-overview" class="anchor"></a>Detailed Overview</h4>
<p>This package makes it easy to manage R from your phone using the Telegram App on your phone. You should be ready to go in less than a minute provided you:</p>
<ul>
<li><p>Have the telegram app installed on your phone.</p></li>
<li><p>Messag botfather (he will appear amongst your contacts automatically) the following:</p></li>
</ul>
<blockquote>
<p>/newbot</p>
</blockquote>
<ul>
<li>
<p>Now simply follow instructions from the Botfather and create a new bot.</p>
<ul>
<li><p>Then, take note of the <strong>Token</strong> botfather provided, and click on the link: t.me/<yourbotname> in the confirmation message from botfather.</yourbotname></p></li>
<li><p>This takes you to the bot. Hit start, and send the bot a simple message to initialise your chat (simply type “hi”).</p></li>
<li><p>You can check the validity of your bot by typing into a browser (replacing YOURTOKEN with your token…): <a href="https://api.telegram.org/botYOURTOKEN/getMe" class="uri">https://api.telegram.org/botYOURTOKEN/getMe</a>.</p></li>
<li><p>If the browser does not give you an error message, it is a valid bot. It should also show you the bot name and bot username.</p></li>
</ul>
</li>
</ul>
<blockquote>
<p>Now simply remember your Token…and try the functions below!</p>
</blockquote>
</div>
</div>
<div id="add_bot" class="section level2">
<h2 class="hasAnchor">
<a href="#add_bot" class="anchor"></a>Add_Bot</h2>
<p>This function makes it easy to store all the needed information from your bot for communication from R, to your computer.</p>
<p>This makes it easier to use your bots, as you will be otherwise required to always input Tokens and IDs (which could be a kill-joy).</p>
<p>This little function will, by default, use the <strong>path.expand(“~”)</strong> location on your computer, but this can be overridden by setting path below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check where this is located on your computer:</span>
<span class="kw">path.expand</span>(<span class="st">"~"</span>)</code></pre></div>
<p>Now, you can save your bot’s information as follows (you will be prompted to enter your bot’s name that appears in your console…):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
Token =<span class="st"> </span>YOURTOKEN  <span class="co"># given by the Botfather...</span>
<span class="kw"><a href="../reference/Add_Bot.html">Add_Bot</a></span>(<span class="dt">Token =</span> Token)</code></pre></div>
<p>You can override the parameters to save this to a specific directory. See ?Add_Bot</p>
<p>If you chose the default, and your bot’s name is: <strong>BOTNAME</strong>, you can now use the following to send messages from R to your bot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
Msg &lt;-<span class="st"> "Hello!"</span>
<span class="kw"><a href="../reference/Text_Bot.html">Text_Bot</a></span>(Msg, <span class="dt">Bot_Name =</span> BOTNAME, <span class="dt">Info_Loc =</span> <span class="ot">NULL</span>, <span class="dt">Token =</span> <span class="ot">NULL</span>, <span class="dt">Silent =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>You can now use messages in your workflow simply, e.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Bot_Name &lt;-<span class="st"> "xxxx"</span>
    
<span class="kw"><a href="../reference/Text_Bot.html">Text_Bot</a></span>(<span class="dt">Msg =</span> <span class="st">"Analysis Started"</span>, Bot_Name)
<span class="kw">foo</span>(x, y)
<span class="kw">foo2</span>(x, y)
<span class="kw"><a href="../reference/Text_Bot.html">Text_Bot</a></span>(<span class="dt">Msg =</span> <span class="st">"Analysis Ended"</span>, Bot_Name)</code></pre></div>
<p>Or of course even send yourself pdf versions of your markdown files after it is built, or figures of your ggplots.</p>
<p>The possibility of using these wrappers is endless.</p>
</div>
<div id="show_bot" class="section level2">
<h2 class="hasAnchor">
<a href="#show_bot" class="anchor"></a>Show_Bot</h2>
<p>This allows you to quickly view what Bots you have saved:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw"><a href="../reference/Show_Bots.html">Show_Bots</a></span>() <span class="co"># Assumes default path.expand("~") is used.</span></code></pre></div>
</div>
<div id="text_bot-img_bot-doc_bot" class="section level2">
<h2 class="hasAnchor">
<a href="#text_bot-img_bot-doc_bot" class="anchor"></a>Text_Bot, Img_Bot, Doc_Bot</h2>
<p>All of these functions work on the same premise:</p>
<ul>
<li><p>Provide your bot’s name in the function</p></li>
<li><p>Add the message, location of a document (e.g. pdf) or the location of a figure on your computer</p></li>
<li><p>Send your meesage, document or figure to your phone.</p></li>
</ul>
<p>By default, the path.expand(“~”) location will be used (run this in R to see where on your computer the location is) to retrieve the saved Bot’s information.</p>
<p>If you prefer not to save your bots’ Tokens on your computer, you could instead directly add your Bot’s Token to each of the functions.</p>
</div>
<div id="foo_bot" class="section level2">
<h2 class="hasAnchor">
<a href="#foo_bot" class="anchor"></a>Foo_Bot</h2>
<p>This function offers a simple workflow for developers to open a connection between Telegram on your phone and their R consoles.</p>
<blockquote>
<p>Note running this function implies your R session will be occupied (talking to Telegram). This can be stopped from your phone or your console.</p>
</blockquote>
<p>The main idea behind this function is to allow you to execute a set of functions on your computer from your phone.</p>
<p>Currently, the function allows you to have 10 functions, with your own calls, open for execution from your phone.</p>
<p>The functions will be safely executed, implying if there is an error - it will not interrupt your connection to the phone. Rather, it will show the error message on your phone, and allow you to keep the connection open.</p>
<p>Another useful addition - is to switch your computer completely off from your phone. This is useful when running computers unattended, specifically in public spaces (e.g. from public terminals).</p>
<p>Your ability to scale this function is limited only by your imagination - e.g. using it in a workflow run from a server where your connection to a bot is constantly open. From it, you could then initialise bash scripts from R, that in turn applies production functions.</p>
<p>Below I show a simple example, as well as an illustration of a workflow using <strong>Foo_Bot</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
Function_List &lt;-<span class="st"> </span><span class="kw">list</span>()

First_Foo &lt;-<span class="st"> </span><span class="cf">function</span>(){
x &lt;-<span class="st"> </span><span class="dv">10</span>
y &lt;-<span class="st"> </span><span class="dv">20</span>
<span class="kw">print</span>(x<span class="op">*</span>y)
<span class="kw">message</span>(<span class="st">"....Function 1 executed...."</span>)

}

Function_List<span class="op">$</span>Foo1 &lt;-
<span class="kw">list</span>(<span class="dt">Function =</span> First_Foo,
<span class="dt">Call =</span> <span class="st">"F1"</span>,  <span class="co"># How to call your function from Telegram</span>
<span class="dt">Message =</span> <span class="st">"First function executed. This function sources the data fetch."</span>)    <span class="co"># What to say when executed in Telegram</span>

Second_Foo &lt;-<span class="st"> </span><span class="cf">function</span>(){

x &lt;-<span class="st"> </span><span class="dv">100</span>
y &lt;-<span class="st"> </span><span class="dv">20</span>

<span class="kw">message</span>(<span class="st">"....Function 2 executed...."</span>)
}


Function_List<span class="op">$</span>Foo2 &lt;-
<span class="kw">list</span>(<span class="dt">Function =</span> Second_Foo,
       <span class="dt">Call =</span> <span class="st">"F2"</span>,  <span class="co"># How to call your function from Telegram</span>
       <span class="dt">Message =</span> <span class="st">"Report is now being built."</span>)    <span class="co"># What to say when executed in Telegram</span>



Error_Foo &lt;-<span class="st"> </span><span class="cf">function</span>(){
<span class="kw">log</span>(a)
<span class="kw">message</span>(<span class="st">"Example of error."</span>)

}

Function_List<span class="op">$</span>FooError &lt;-
<span class="kw">list</span>(<span class="dt">Function =</span> Error_Foo,
<span class="dt">Call =</span> <span class="st">"Error_Exmple"</span>,  <span class="co"># How to call your function from Telegram</span>
<span class="dt">Message =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">Error function illustrated: </span><span class="ch">\n</span><span class="st">This illustrates that the connection with the phone will  be preserved using purrr::safely"</span>)    <span class="co"># What to say when executed in Telegram</span>



 Bot_Name &lt;-<span class="st"> "Gobot"</span>
 <span class="kw"><a href="../reference/Foo_Bot.html">Foo_Bot</a></span>(<span class="dt">Bot_Name =</span> Bot_Name, <span class="dt">Function_List =</span> Function_List, <span class="dt">LoadMessage =</span> <span class="st">"My connection with R"</span> )
    </code></pre></div>
<div id="safe-functions" class="section level4">
<h4 class="hasAnchor">
<a href="#safe-functions" class="anchor"></a>Safe functions</h4>
<ul>
<li><p>The functions above are safe - implying an error will not break the connection.</p></li>
<li><p>Using the purrr package’s safely call, it will produce an error message, while keeping the connection open.</p></li>
<li><p>See the silly example below.</p></li>
</ul>
<blockquote>
<p>Also note, in this example I add the command to restart R (as opposed to simply stopping connection), as well as a command to shut down the computer:</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
Function_List &lt;-<span class="st"> </span><span class="kw">list</span>()

Error_Foo &lt;-<span class="st"> </span><span class="cf">function</span>(){

<span class="kw">log</span>(a)
<span class="kw">print</span>(<span class="st">"....Message 1 executed...."</span>)

}

Function_List<span class="op">$</span>Foo1 &lt;-
<span class="kw">list</span>(<span class="dt">Function =</span> Error_Foo,
<span class="dt">Call =</span> <span class="st">"Error_func"</span>,  <span class="co"># How to call your function from Telegram</span>
<span class="dt">Message =</span> <span class="st">"First function executed."</span>)    <span class="co"># What to say when executed in Telegram</span>

Second_Foo &lt;-<span class="st"> </span><span class="cf">function</span>(){

x &lt;-<span class="st"> </span><span class="dv">100</span>
y &lt;-<span class="st"> </span><span class="dv">20</span>

<span class="kw">print</span>(<span class="st">"....Message 2 executed...."</span>)
}

Function_List<span class="op">$</span>Foo2 &lt;-
<span class="kw">list</span>(<span class="dt">Function =</span> Second_Foo,
       <span class="dt">Call =</span> <span class="st">"F2"</span>,  <span class="co"># How to call your function from Telegram</span>
       <span class="dt">Message =</span> <span class="st">"Report is now being built."</span>)    <span class="co"># What to say when executed in Telegram</span>

 Bot_Name &lt;-<span class="st"> "NewBot"</span>
 <span class="kw"><a href="../reference/Foo_Bot.html">Foo_Bot</a></span>(<span class="dt">Bot_Name =</span> Bot_Name, <span class="dt">Function_List =</span> Function_List, <span class="dt">LoadMessage =</span> <span class="st">"My connection with R"</span>, <span class="dt">KillR =</span> <span class="ot">TRUE</span>, <span class="dt">KillCPU =</span> <span class="ot">TRUE</span> )</code></pre></div>
</div>
<div id="source-functions" class="section level4">
<h4 class="hasAnchor">
<a href="#source-functions" class="anchor"></a>Source functions</h4>
<p>Ideally, you should use foo_bot to source R scripts that achieve your intended goals.</p>
</div>
<div id="more" class="section level4">
<h4 class="hasAnchor">
<a href="#more" class="anchor"></a>More</h4>
<p>For more details on the functions, use: ?<functionname></functionname></p>
<p>I hope you enjoy the teamwork from R and your phone from now on. You are welcome to submit any additions to this package on github.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#rbot-making-r-and-your-phone-best-friends">Rbot: Making R and your Phone Best Friends</a></li>
      <li><a href="#add_bot">Add_Bot</a></li>
      <li><a href="#show_bot">Show_Bot</a></li>
      <li><a href="#text_bot-img_bot-doc_bot">Text_Bot, Img_Bot, Doc_Bot</a></li>
      <li><a href="#foo_bot">Foo_Bot</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nico Katzke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
